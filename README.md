# quantify-infrastructure
This project quantifies the residential built up volume and loacl roadway length for U.S. cities and project upto 2100 to measure the infrastructure burden.
The data and analysis for the project is organized as follows:

```bash
quantify-infrastructure/

├── data/
    └── ghsl
    └── housing_data_ACS
    └── osm
    └── population
    └── scripts_data_dowmload
├── scripts/
    └── functions
        └── functions_scaling_vect.py
    └── scenarios
        └── process_RBUV_data.py
        └── process_RL_data.py
        └── project_infrastructure_ssp1.py
        └── project_infrastructure_ssp2.py
        └── project_infrastructure_ssp4.py
    └── plots_stats
        └── perCapInfra_stats_clean.ipynb
        └── quantify_burden.ipynb
        └── plot_density-distn.ipynb
        └── plot_burdenExtent.ipynb
        └── plot_gifs.ipynb
        └── get_df_ssp.py
        └── plot_funcs.py 
├── outputfiles/
    └── output.txt (contains terminal output once main.py is run)
    └── csvs       (contains all the output csv files)
    └── figures    (contains all the output figures)
   
```

### 1. **`data/`** 
This folder contains the raw data files necessary for the analysis. It is organized into the following subfolders:

- **`ghsl/`**: Contains data from the Global Human Settlement Layer (GHSL), which includes built up volume, surface and Nonresidentual volume and surface aggregated to city level.
- **`housing_data_ACS/`**: Contains data on household percentage and age from American Comminuty Survey (ACS) at place level.
- **`osm/`**: Contains data extracted from OpenStreetMap data for cities in each state.
- **`population/`**: Contains datasets related to population forecasts for each decade and socio-demographics attributes.
- **`scripts_data_dowmload/`**: Contains scripts used to extract data grom GHSL and OSM databases.

Notes abour **`scripts_data_dowmload`**:
- **`extract GHSL data.txt`**: Residential built up volume (RBUV) is extracted from Google Earth Engine Code editor using summarized per city/place.
- **`0_read_OSM_2_streetsdf_final.ipynb/0_read_OSM_2_streetsdf_CFT_final.ipynb`**: Roadway network length (RL) is extracted from OpenStreetMap and coverted to dataframes summarized by roadway type for cities.
This data extraction process takes some time and the files are too big. Therefore, only processed input files have been provided in the data folder.
To extract data for a single place,
unit data for built up volume can be accessed using this file: **`https://code.earthengine.google.com/31f072870e93ccad4fb8f0e1b6f4efb3`**

### 2. **`scripts/`**
This folder contains all the Python (or R) scripts that are used for processing, analyzing, and visualizing the data. The scripts should be run in the appropriate environment with necessary dependencies installed.

functions: Contains the functions for initial data processing before analysis and function to fit urban scaling law     \
scenarios: Fits urban scaling laws to SSP1, SSP2 and SSP4 population projections to get future RBUV and RL              \
         ── process files process RBUV and RL data                                                                      \
         ── project files project RBUV and RL for three SSP scenarios upto 2100 at each decade interval                 \
plots_stats: Shows the anlaysis outcomes as jupyter notebooks                                                           \
         ── `get_df_ssp.py` (combines analysis outputs for the three SSP sceanrios)                                     \
         ── `plot_funcs.py` (creates frequently used plots)                                                               

### 3. **`outputfiles/`**
This folder holds the results generated from the scripts. It is divided into two subfolders:

- **`figures/`**: Stores any visual outputs, such as charts, graphs, and maps generated by the scripts.
- **`csvs/`**: Contains the CSV files with processed data or output generated from the analysis.
- **`df_ssp2_clean`**: Final output dataset with per capita residential built volume (m3) and roadway length (m) at every decade time interval for scenario SSP 2.
- **`DD_df_ssp2_clean`**: Data dictionary for **`df_ssp2_clean.csv`**
  

## To run the analysis in local machines:

### Prerequisites
Before running the scripts, make sure to have the following installed:
- Python (version 3.12)
- Required libraries (listed in `requirements.txt`, also provided as `environment.yml`)

### Run the model
- To run the environemnt with all dependencies inside conda
- Download the `quantify-infrastructure` folder
- Open the teminal/ command prompt for conda and exceute the following:
    ```bash
    conda env create -f environment.yml 
     ```
- or the following 

    ```bash
    conda create --name quantify-infrastructure --file requirements.txt # conda create --name <env> --file <this file>
     ```
Installing the envirnment take some time (15-20 minutes)

- To run the project:
- Open terminal
- Navigate to the `quantify-infrastructure` folder
   ```bash
   conda activate quantify-infrastructure
   cd quantify-infrastructure # set current directory to quantify-infrastructure
   python main.py  # to get future per capita RBUV and RL values for SSP1, SSP2 and SSP4 scenarios
   ```
It takes ~10 minutes to run each scerarios for RBUV or RL.
Running main.py results is 3 output files for each scenario. For example for scenario 2, the output files are 
buildings_perCap_ssp2.csv, 
output_city_type_ssp2.csv, and 
roads_perCap_ssp2_local.csv
Output files are saved in the csvs folder inside outputfiles. A text file containing Standard Output is also generated and saved in the outputfiles folder. 

### Once you have the output files for three scenarios 
### Generate the figures and compare analysis results
- Open your IDE for python. Open quantify-infrastructure folder.
- Navigate to the `scripts/plots_stats` folder
- Select any of the files and run
  ```bash
   perCapInfra_stats_clean.ipynb
   quantify_burden.ipynb
   plot_density-distn.ipynb
   plot_burdenExtent.ipynb
   ```
   To get the temporal change in burden with population threshold, prepare data using `process_data_ggdensityR.ipynb` and run the script `ggdensity_plots.R` in RStudio.
